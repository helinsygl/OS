# Advanced Memory Operations Test
# Test complex memory addressing and operations

Begin Data Section
0 20          # PC starts at instruction 20
1 5000        # SP 
2 0           # Syscall result
3 0           # Instructions executed
100 42        # Test value 1
101 0         # Result storage
102 200       # Pointer to address 200
103 300       # Pointer to address 300
200 88        # Value at indirect address
300 0         # Storage for indirect operations
400 150       # Another test value
End Data Section

Begin Instruction Section
# Test SET and CPY
20 SET 123 101     # memory[101] = 123
21 SYSCALL PRN 101 # Print 123
22 CPY 100 101     # Copy memory[100] to memory[101] 
23 SYSCALL PRN 101 # Print 42

# Test indirect operations CPYI
24 CPYI 102 101    # Copy memory[memory[102]] to memory[101]
25 SYSCALL PRN 101 # Should print 88 (value at address 200)

# Test CPYI2 - both addresses indirect
26 SET 101 200     # Set memory[200] = 101 (current value of 101)
27 CPYI2 102 103   # Copy memory[memory[102]] to memory[memory[103]]
28 CPYI 103 101    # Load result to check
29 SYSCALL PRN 101 # Should print the copied value

# Test arithmetic operations
30 SET 10 101      # memory[101] = 10
31 ADD 101 15      # memory[101] = 10 + 15 = 25
32 SYSCALL PRN 101 # Print 25

33 SET 5 400       # memory[400] = 5
34 ADDI 101 400    # memory[101] = memory[101] + memory[400] = 25 + 5 = 30
35 SYSCALL PRN 101 # Print 30

36 SET 8 400       # memory[400] = 8
37 SUBI 101 400    # memory[400] = memory[101] - memory[400] = 30 - 8 = 22
38 SYSCALL PRN 400 # Print 22

# Test conditional jump
39 SET 0 101       # memory[101] = 0
40 JIF 101 45      # Should jump to 45 because 0 <= 0
41 SYSCALL PRN 999 # Should not execute
42 SET 999 101     # Should not execute
43 SYSCALL PRN 101 # Should not execute
44 HLT             # Should not execute

45 SYSCALL PRN 101 # Should print 0 (jumped successfully)
46 SET 1 101       # memory[101] = 1  
47 JIF 101 52      # Should NOT jump because 1 > 0
48 SYSCALL PRN 101 # Should print 1 (did not jump)
49 SET 777 101     # Should execute
50 SYSCALL PRN 101 # Should print 777
51 HLT             # End test

52 SYSCALL PRN 888 # Should not reach here
53 HLT
End Instruction Section